import { Ora } from 'ora';
import { Command, Config } from '@react-native-community/cli-types';
export declare type OptionalResourceFunction = (ctx: Config, args: unknown) => Resource<unknown, unknown> | null;
/**
 * A Resource is something needed by a command - which may be the output of the command itself. We
 * perform a check for the resource, then generate or parse it, and then provide the resource to
 * the user or the resource which has a dependency on it. The func here is an asynchronous
 * validation of the content of a resource like a file, or it may generate the required resource.
 */
export declare type Resource<T, U> = Pick<Command, 'name' | 'options' | 'description' | 'examples'> & {
    /**
     * Text is displayed on spinners or directly output (depending on verbosity) as various stages of
     * resource acquisition and validation are performed.
     *
     * @remarks
     * The lifecycle of a resource is:
     * starting -> awaiting (each dependency resource reaches success) -> inProgress -> success
     *
     * Exceptions can be encountered at two states:
     * - awaiting: If any dependency throws an exception, this resource will move to the failure
     *   state
     * - inProgress: If this resource's `func` throws an exception, this resource will move to the
     *   failure state
     *
     * A resource failing will cause the CLI process to exit with a non-zero status code. Use
     * logger.error to communicate any additional information before throwing a CLIError
     */
    text: {
        starting?: string;
        awaiting?: string;
        inProgress: string;
        success?: string;
        failure?: string;
    };
    /**
     * A resource's `func` is a specialized function similar to a standard RN CLI Command Func, but
     * which does not use `argv` and instead receives additional information such as a spinner and
     * dependencies
     * @param ctx - the React Native Config object. This is the same value returned by the CLI
     *              command `react-native config`. This config is enhanced with kepler-specific
     *              values, see {@link platform#projectConfig | projectConfig in platform.ts} for
     *              more details on the contents of this Type.
     * @param args - The arguments for this function, filled in with values. This works the same as
     *               RN CLI Commands, see
     *               {@link https://github.com/react-native-community/cli/blob/6.x/docs/plugins.md#command-interface | the RN CLI Plugin documentation}
     *               for more information
     * @param spinner - the spinner is an Ora instance, which can be used to control the content of
     *                  the spinner if more control is desired besides the standard lifecycle display
     *                  handled by the conventions in Resource. See
     *                  {@link https://github.com/sindresorhus/ora | Ora's github page} for more
     *                  information on Ora
     * @param dependencies - Dependencies is the result of each resource specified in dependency
     *                       returning. Each named dependency will have the result which its promise
     *                       was fulfilled with populated within this Record object under the same
     *                       key used in `dependencies`
     * @returns a Promise that will be fulfilled with a value of the Type which this resource
     *          provides. For example, the SDK resource provides the base path of the SDK, the SDK
     *          Config resource provides a parsed and validated SDK Config, an SDK Tool resource
     *          provides the path to a tool, and the Bundle resource provides a path to a bundle file.
     */
    func: (ctx: Config, args: U, spinner: Ora, dependencies: Record<string, any>) => Promise<T>;
    /**
     * The resources this resource needs before it can retrieve its value.
     *
     * @remarks
     * Each of these dependencies will be executed with the configuration and arguments supplied to
     * this Resource, as well as its own dedicated spinner and its own dependencies. When all
     * dependencies fulfill, the resource that depends on them will have its `func` called. The key
     * for each dependency listed here will be used in the dependencies param used by `func` and the
     * value returned by this dependency resource's `func` will be the value of the record for that
     * key.
     */
    dependencies: {
        [key: string]: Resource<any, any> | OptionalResourceFunction;
    };
    dedupeArgs?: string[];
};
/**
 * This helper function is used for tests to reset the stored promises
 */
export declare const resetStoredPromises: () => void;
/**
 * Get the value of a resource. A command from a resource will rely on this as the primary means of
 * executing the command. Resources will automatically retrieve resources in their `dependencies`.
 * This is essentially a wrapper around a glorified promise - it provides some information to the
 * function as well as wraps the execution in some nice spinners and standard logging for
 * communication to users on the status of commands.
 *
 * @param resource - The resource to get the value of, which will require getting its dependencies
 *                   (if applicable)
 * @param ctx - Context, a React Native Config. This is usually unused, in favor of the arguments
 *              which have defaults populated from this configuration.
 * @param args - The arguments supplied from the command line arguments as processed through the RN
 *               CLI's standard argument processing system (this itself is a variation on the
 *               commands used by Commander.js)
 *
 * @returns a promise which will be fulfilled with the value of the resource or rejected if an
 *          error occurs either in its dependencies or its own execution
 */
export declare const getResourceValue: <T, U>(resource: Resource<T, U>, ctx: Config, args: U) => Promise<T>;
/**
 * Creates an RN CLI Command for the given resource, wrapping the resource func in getResourceValue.
 *
 * @param resource - the resource to be made into a Command for the RN CLI
 * @returns an RN CLI command usable in the RN CLI plugin definition
 *
 * @remarks
 * This is a means of exposing a Resource to users of the CLI as a command.
 *
 * A resource's dependencies are often available as their own commands, but within a Resource no
 * Commands should be assumed to be available - instead use Resources directly. Keep the user
 * settings and interactions at the Command level, and keep Resources concerned only about finding,
 * using, and generating resources needed by users. @param resource - the resource to be made into
 * a Command
 *
 */
export declare const commandForResource: <T, U>(resource: Resource<T, U>) => Command<false>;

#!/usr/bin/env node

/**
 * Copyright (c) 2023 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * PROPRIETARY/CONFIDENTIAL
 *
 * Use is subject to license terms.
 *
 */

const yargs = require('yargs');
const codegen = require('./dist/kepler-codegen/execute-codegen.js').default;

const argv = yargs
  .command('codegen <path>', 'Run the Kepler Codegen tool. Creates C++ implementation and Spec files.', (y) => {
    return y.positional('path', {
        describe: 'Path to the TypeScript module interface',
        type: 'filepath',
      })
      .option('o', {
        alias: 'outputPath',
        type: 'filepath',
        description: 'Path where generated artifacts will be output to.',
        default: './kepler/turbo-modules',
      })
      .option('s', {
        alias: 'namespace',
        type: 'string',
        description: 'C++ namespace for the TurboModule',
        default: 'myTurboModule',
      })
      .option('c', {
        alias: 'classname',
        type: 'string',
        description: 'C++ classname for the TurboModule. Defaults to match TurboModule registry.',
        default: '',
      })
      .option('f', {
        alias: 'outFile',
        type: 'string',
        description: 'Module name to use for the generated filenames. Defaults to match TurboModule registry.',
        default: '',
      })
      .boolean('new')
      .alias('new', ['n'])
      .describe('new', 'When enabled, implementation files can be overwritten. Native Spec files are always overwritten.')
      .default('new', false);
  })
  .demandCommand(1, 'Please specify a command.')
  .help()
  .parse();

codegen(argv);

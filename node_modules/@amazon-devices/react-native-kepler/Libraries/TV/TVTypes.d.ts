/**
 * Copyright (c) 2023 Amazon.com, Inc. or its affiliates.  All rights reserved.
 *
 * PROPRIETARY/CONFIDENTIAL.  USE IS SUBJECT TO LICENSE TERMS.
 */

import * as React from "react";
import { View, ViewProps, HostComponent, ScrollViewProps } from "react-native";

// @amznmod_react - TVEventHandler for Kepler.
/**
 * TVEventHandler and its respective hook useTVEventHandler are listeners
 * for TV remote events. The UserInputManager class fires a JS event which
 * are handled by the callback respectively for implementation of custom handling
 * to these events.
 *
 * HWEvent: Data emitted from the native event emitter.
 *  eventType:
 *      up - This event is received when the UP DPaD control is triggered.
 *      down - This event is received when the DOWN DPaD control is triggered.
 *      right - This event is received when the RIGHT DPaD control is triggered.
 *      left - This event is received when the LEFT DPaD control is triggered.
 *      select - This event is received when the RETURN DPaD control is triggered.
 *      menu - This event is received when the MENU DPaD control is triggered.
 *      back - This event is received when the BACK DPaD control is triggered.
 *      playpause - This event is received when the PLAY/PAUSE DPaD control is triggered.
 *      rewind - This event is received when the REWIND DPaD control is triggered.
 *      forward - This event is received when the FORWARD DPaD control is triggered.
 *
 *  eventAction:
 *       0 : The respective key is in the pressed/KEY_DOWN state.
 *       1 : The respective key is in the released/KEY_UP state.  
 *
 *  deviceIdentifier: object
 *       the device identifier: the device id of which produces this key event.
 *       it contains the following fields:
 *         uniqueId?: string, for example: 90:39:5F:2C:0C:06 (Bluetooth Address)
 *         busId?: number, for example: 0x0005 bluetooth
 *         vendorId?: number, for exmaple: 0x0171
 *         productId?: number, for example: 0x042f
 *         version?: number, for example: 0x0060
 *
 * @see https://reactnative.dev/docs/building-for-tv
 */
export type HWEvent = {
    eventType:  'num_0' | 'num_1' | 'num_2' | 'num_3' | 'num_4' | 'num_5' | 'num_6' | 'num_7' | 'num_8' | 'num_9'
    | 'num_11' | 'num_12' | 'up' | 'down' | 'right' | 'left' | 'left_up' | 'left_down' | 'right_up' | 'right_down'| 'select' | 'menu' | 'root_menu' | 'media_top_menu' 
    | 'context_menu' |'back' | 'playpause' | 'skip_backward' | 'skip_forward' | 'period' | 'clear' | 'enter'| 'power' | 'volume_up' | 'volume_down' | 'mute' | 'pause' 
    | 'stop' | 'record' |  'eject' | 'page_up' | 'page_down' | 'page_left' | 'page_right' | 'info' | 'more' | 'help'| 'channel_up' | 'channel_down' | 'red' | 'blue' 
    | 'green' | 'yellow' |'data' | 'f5'  | string;
    eventKeyAction?: -1 | 1 | 0 | number;
    deviceIdentifier?: {
      uniqueId?: string;
      busId?: number;
      vendorId?: number;
      productId?: number;
      version?: number;
    };
};


export const useTVEventHandler: (handleEvent: (event: HWEvent) => void) => void;

export class TVEventHandler {
    enable<T extends React.Component<unknown>>(
        component?: T,
        callback?: (component: T, data: HWEvent) => void
    ): void;
    disable(): void;
}

// amznmod_react - TVViewProps extends RN View Props
interface TVViewProps extends ViewProps {
  /**
   * TV next focus down (see documentation for the View component).
   */
  nextFocusDown?: number | undefined,

  /**
   * TV next focus forward (see documentation for the View component).
   *
   * @platform android
   */
  nextFocusForward?: number | undefined,

  /**
   * TV next focus left (see documentation for the View component).
   */
  nextFocusLeft?: number | undefined,

  /**
   * TV next focus right (see documentation for the View component).
   */
  nextFocusRight?: number | undefined,

  /**
   * TV next focus up (see documentation for the View component).
   */
  nextFocusUp?: number | undefined,
}

// amznmod_react - TVFocusGuideView for Kepler.
export interface FocusGuideProps extends TVViewProps {
    /**
     * If the view should be "visible". display "flex" if visible, otherwise "none".
     * Defaults to true
     */
    enabled?: boolean;
    /**
     * Array of `Component`s to register as destinations with `UIFocusGuide`
     */
    destinations?: (null | number | React.Component<any, any> | React.ComponentClass<any>)[];
    /**
     * If true, `TVFocusGuide` will automatically manage focus for you.
     * It will redirect the focus to the first focusable child on the first visit.
     * It also remembers the last focused child and redirects the focus
     * to it on the subsequent visits.
     *
     * `destinations` prop takes precedence over this prop when used together.
     *
     * @default false
     */
    autoFocus?: boolean;
    /**
     * Enables focus trapping for the focus guide (see README).
     */
    trapFocusUp?: boolean;
    /**
     * Enables focus trapping for the focus guide (see README).
     */
    trapFocusDown?: boolean;
    /**
     * Enables focus trapping for the focus guide (see README).
     */
    trapFocusLeft?: boolean;
    /**
     * Enables focus trapping for the focus guide (see README).
     */
    trapFocusRight?: boolean;
    /**
     * @deprecated Don't use it, no longer necessary.
     */
    safePadding?: 'both' | 'vertical' | 'horizontal' | null;
}

export type FocusGuideMethods = {
  setDestinations: (
    destinations: (React.ElementRef<HostComponent<unknown>> | null | undefined)[],
  ) => void;
}

/**
 * This component provides support for Apple's `UIFocusGuide` API,
 * to help ensure that focusable controls can be navigated to,
 * even if they are not directly in line with other controls on both tvOS and Android.
 * An example is provided in `RNTester` that shows different ways of using this component.
 * https://github.com/react-native-tvos/react-native-tvos/blob/tvos-v0.69.8/packages/rn-tester/js/examples/TVFocusGuide/TVFocusGuideAutoFocusExample.js
 */
export const TVFocusGuideView: React.ForwardRefExoticComponent<FocusGuideProps & React.RefAttributes<View & FocusGuideMethods>>;

export interface TVTextScrollViewProps extends ScrollViewProps {
  /**
   * The duration of the scroll animation when a swipe is detected.
   * Default value is 0.3 s
   */
  scrollDuration?: number | undefined;
  /**
   * Scrolling distance when a swipe is detected
   * Default value is half the visible height (vertical scroller)
   * or width (horizontal scroller)
   */
  pageSize?: number | undefined;
  /**
   * If true, will scroll to start when focus moves out past the beginning
   * of the scroller
   * Defaults to true
   */
  snapToStart?: boolean | undefined;
  /**
   * If true, will scroll to end when focus moves out past the end of the
   * scroller
   * Defaults to true
   */
  snapToEnd?: boolean | undefined;
  /**
   * Called when the scroller comes into focus (e.g. for highlighting)
   */
  onFocus?(evt: HWEvent): void;
  /**
   * Called when the scroller goes out of focus
   */
  onBlur?(evt: HWEvent): void;
}

export class TVTextScrollView extends React.Component<TVTextScrollViewProps> {}
"use strict";
/**
 * Copyright (c) 2024 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * PROPRIETARY/CONFIDENTIAL
 *
 * Use is subject to license terms.
 *
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateKeplerCode = void 0;
const RNCodegenUtils_1 = require("../RNCodegenUtils");
const invariant_1 = require("../../invariant/invariant");
const GenerateModuleSpecH_1 = require("./modules/GenerateModuleSpecH");
const GenerateModuleSpecCpp_1 = require("./modules/GenerateModuleSpecCpp");
const GenerateModuleH_1 = require("./modules/GenerateModuleH");
const GenerateModuleCpp_1 = require("./modules/GenerateModuleCpp");
const generators = [
    GenerateModuleSpecH_1.default,
    GenerateModuleSpecCpp_1.default,
    GenerateModuleH_1.default,
    GenerateModuleCpp_1.default,
];
const generateKeplerCode = (metadata, schema) => {
    const nativeModules = (0, RNCodegenUtils_1.getModules)(schema);
    const jsFileNames = Object.keys(nativeModules);
    (0, invariant_1.default)(jsFileNames.length === 1, 'Kepler Codegen only accepts one module at a time.');
    const nativeModule = nativeModules[jsFileNames[0]];
    const moduleName = nativeModule.moduleName;
    metadata.classname = metadata.classname ? metadata.classname : moduleName;
    metadata.filePrefix = metadata.filePrefix ? metadata.filePrefix : moduleName;
    console.log(`[KeplerCodegen] Module name: "${moduleName}"`);
    console.log(`[KeplerCodegen] Class name: "${metadata.classname}"`);
    console.log(`[KeplerCodegen] File prefix: "${metadata.filePrefix}"`);
    console.log(`[KeplerCodegen] namespace: "${metadata.cxxnamespace}"`);
    return generators.map((generator) => generator(metadata, moduleName, nativeModule));
};
exports.generateKeplerCode = generateKeplerCode;

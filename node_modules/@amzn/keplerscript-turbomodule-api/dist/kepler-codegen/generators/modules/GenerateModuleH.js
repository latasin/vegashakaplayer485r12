"use strict";
/**
 * Copyright (c) 2024 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * PROPRIETARY/CONFIDENTIAL
 *
 * Use is subject to license terms.
 *
 */
Object.defineProperty(exports, "__esModule", { value: true });
const RNCodegenUtils_1 = require("../../RNCodegenUtils");
const GenerateModuleSpecH_1 = require("./GenerateModuleSpecH");
/**
 * Creates a module header file.
 * One file can contain multiple modules.
 *
 * @param libraryName {string} The library name used for spec file naming.
 * @param modules {string[]} Array of module contents as strings.
 * @returns file spec code as string.
 */
const FileTemplate = (libraryName, cxxnamespace, nativeModule) => {
    return `/**
 * This code was generated by the Kepler Codegen tool.
 * 
 * It is provided as a starting template and can be modified.
 * 
 * @generated by GenerateModuleH.js
 */

#include "generated/${libraryName}Spec.h"

namespace ${cxxnamespace} {

${nativeModule}

} // namespace ${cxxnamespace}
`;
};
/**
 * Creates an implementation header template for an individual module.
 *
 * @param className {string} C++ class name of the module.
 * @param moduleProperties {string[]} Array of module properties (methods) as strings.
 * @returns module spec code as string.
 */
const ModuleImplHeaderTemplate = (className, moduleProperties) => {
    return `class ${className} : public ${className}Spec {
public:
  ${className}();
  ~${className}() noexcept;

  ${(0, RNCodegenUtils_1.indent)(moduleProperties.join('\n'), 2)}
};`;
};
/**
 * Transforms a Codegen Schema into a C++ Kepler Turbo Module .h template.
 *
 * @param libraryName {string} Used for the generated file name.
 * @param schema {SchemaType} The Kepler-annotated Codegen Schema for the library/modules.
 * @returns
 */
const generate = (metadata, moduleName, schema) => {
    const { aliasMap, spec: { properties }, } = schema;
    const { filePrefix, cxxnamespace, classname } = metadata;
    const resolveAlias = (0, RNCodegenUtils_1.createAliasResolver)(aliasMap);
    const filename = `${filePrefix}.h`;
    return {
        filename,
        contents: FileTemplate(filePrefix, cxxnamespace, ModuleImplHeaderTemplate(classname, properties.map((prop) => (0, GenerateModuleSpecH_1.translatePropertyToCpp)(classname, prop, resolveAlias, false)))),
        alwaysWrite: false,
    };
};
exports.default = generate;

"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.useServerChallengeReceived = void 0;
const react_1 = require("react");
const RCTNetworking_kepler_1 = __importDefault(require("./RCTNetworking.kepler"));
const useServerChallengeReceived = () => {
    const [isChallengeReceived, setChallengeReceived] = react_1.useState(0);
    const challengeUrlRef = react_1.useRef(null);
    const setAuthCert = ({ url, clientCert, clientKey }) => {
        if (!url || !clientCert) {
            console.error("setAuthCert: missing required parameters");
            return;
        }
        RCTNetworking_kepler_1.default.setAuthCertificate({ url, clientCert, clientKey });
    };
    react_1.useEffect(() => {
        const listener = RCTNetworking_kepler_1.default.addListener("didReceiveAuthChallenge", (event) => {
            challengeUrlRef.current = event[0] || null;
            setChallengeReceived(prevCount => prevCount + 1);
        });
        return () => {
            listener.remove();
        };
    }, []);
    return { isChallengeReceived, setAuthCert, challengeUrl: challengeUrlRef.current };
};
exports.useServerChallengeReceived = useServerChallengeReceived;
